<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link href="static/roller_app/style.css" type="text/css" rel="stylesheet"/>
    <script>
        function roll_result(response) {
            if (response.target.readyState === 4) {
//                console.log(response.target.responseText);
                var data = JSON.parse(response.target.responseText);
                var element=document.getElementById("roll_result_data");
                element.innerHTML+=data.result + ", ";
            }
        }

        function reset_roll(){
            var element=document.getElementById("roll_result_data");
                element.innerHTML="&nbsp;";
        }

        function init(){
            document.getElementById("roll_reset").addEventListener("click", reset_roll);
        }


        document.addEventListener("DOMContentLoaded",init);


        console.log("Head Script");
        function roll(number) {
            request = new XMLHttpRequest();
            request.onreadystatechange = roll_result;
            request.open('GET', "/api_dice_roll/" + number + "/", true);
            request.send()
        }

        function rollClick(event){
            var image=event.target;
            var button=image.parentElement;
            console.log(button);
            var id=button.getAttribute("id");
            console.log(id);
            var parts=id.split("_");
            var number=parts[1];
            console.log(number);
            roll(number)
        }

        document.addEventListener("DOMContentLoaded", function () {
            var x = document.getElementsByClassName("die");
            var i;
            for (i = 0; i < x.length; i++) {
                x[i].addEventListener("click", rollClick, true)
            }
        });

        function swapImage(){
            var image = document.getElementById("imageToSwap");
            var dropd = document.getElementById("map");
            image.src = dropd.value;
        }

//        function lightbox_map(){
//            document.getElementById("dialog_image").addEventListener("click", function(){
//                document.getElementById("map1").innerHTML="Hello World";
//            });
//        }





    </script>
    <!--<script>-->
        <!--function load_dice_roller() {-->
            <!--document.getElementById("content").innerHTML='<object type="text/html" data="dice_roller.html"></object>;-->
        <!--}-->
    <!--</script>-->


</head>
<body>

    <div id="Header">This space is for character import window. It will contain a block for a character record.
    It will also contain two drop down menus; one to adjust the map in map-view and one to select a new character.

    </div>
    <div id="Content1">Game Log window, it will reflect changes to the character during combat.</div>
    <div id="Content2">
     <!--<form id="mapForm">Map Select-->
    <img id="imageToSwap"/>&emsp;Map Selection:
        <select id="map" onchange="swapImage()">
            <option value="">Choose a Map</option>
            <option id="map1" value="/static/roller_app/images/hinterlands.jpg">Hinterlands</option>
            <option id="map2" value="/static/roller_app/images/sandpoint.jpg">Sandpoint</option>
            <option id="map3" value="/static/roller_app/images/lair.jpg">Lair</option>
        </select>

    <!--</form>-->
    </div>
<!--<div id="dialog_background"><div id="dialog_content"><img id="dialog_image"></div></div>-->

</body>
<div id="Footer">
    <table>
    <tr>
        <td><input type="reset" value="Reset Roll" id="roll_reset"></td>
    </tr>
    <tr>

        <td><button class="die" id="d_4"><img src="/static/roller_app/images/d4.jpg" width="70" height="60"/>d4</button></td>
        <td><button class="die" id="d_6"><img src="/static/roller_app/images/d6.jpg" width="70" height="60"/>d6</button></td>
        <td><button class="die" id="d_8"><img src="/static/roller_app/images/d8.jpeg" width="70" height="60"/>d8</button></td>
        <td><button class="die" id="d_10"><img src="/static/roller_app/images/d10.png" width="70" height="60"/>d10</button></td>
        <td><button class="die" id="d_12"><img src="/static/roller_app/images/d12.jpeg" width="70" height="60"/>d12</button></td>
        <td><button class="die" id="d_20"><img src="/static/roller_app/images/d20.jpg" width="70" height="60"/>d20</button></td>
</tr>
    <tfoot>
    <tr>
        <td colspan="6"><div id="rollResultList">Roll Result:<span id="roll_result_data"></span></div></td>
    </tr>
    </tfoot>
</table>
<!--<div id ="content"><a href ="#" onload="load_dice_roller()"></a> </div>-->
</html>